<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="./style.css" />
    <link
      rel="icon"
      type="image/x-icon"
      href="https://tse1-mm.cn.bing.net/th/id/OIP-C.lU4kOMw5lwhBp2-8nT0t0QHaH-?rs=1&pid=ImgDetMain"
    />
    <title>Earn</title>
  </head>
  <div class="flex-container">
    <div>
      <button class="logout" onclick="refresh()">Refresh</button>
    </div>
    <div>
      <a href="./index.html">
        <button class="logout">Log Out</button>
      </a>
    </div>
    <div>
      <a href="./control.html">
        <button class="logout">Control</button>
      </a>
    </div>
  </div>
 
  <h1 class="center">Welcome to your Moo Moo Money (MÂ³) Account!</h1>
  <a href="./world.html">
    <img src="cow.jpg" alt="logo" width="150" height="150" class="img" />
  </a>
  <div class="grid-display">
    <div class="grid-item">
      <p class="grid-title">Available Coins</p>
    </div>
    <div class="grid-item">
      <p class="grid-title">Today's Income</p>
    </div>
    <div class="grid-item">
      <p class="grid-title">Today's Losses</p>
    </div>
    <div class="grid-item">
      <p class="grid-title">Auto Earning <a href="world.html"><img src="question.png" alt="auto earn" width="20" height="20"/></a></p>
    </div>
    <!--Avaiable Coins-->
    <div class="grid-item">
      <p class="coins"></p>
    </div>
    <!--Income-->
    <div class="grid-item">
      <p class="income"></p>
    </div>
    <!--Losses-->
    <div class="grid-item">
      <p class="losses"></p>
    </div>
    <!--Auto Earn-->
    <div class="grid-item">
      <p class="auto"></p>
    </div>
  </div>
  <div class="navbar">
    <a href="./earn.html">Earn</a>
    <a href="./redeem.html">Redeem</a>
    <a href="./track.html">Track</a>
  </div>
<script src="script.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
<script src="firebase-config.js"></script>
<script>
  // Fetch and display current coin count on page load
  function getCoinCount() {
    coinsRef.get().then(snapshot => {
      if (snapshot.exists()) {
        document.getElementById("coinDisplay").innerText = snapshot.val();
      } else {
        console.log("No data available");
      }
    }).catch(error => {
      console.error(error);
    });
  }

  // Update coin count in Firebase
  function updateCoinCount(count) {
    coinsRef.set(count);  // Updates the coin count in Firebase
    getCoinCount();       // Fetch and display updated count
  }

  // Listen for real-time changes in coin count
  coinsRef.on('value', (snapshot) => {
    const coinCount = snapshot.val();
    document.getElementById("coinDisplay").innerText = coinCount;
  });

  // Initialize page with current coin count
  getCoinCount();
</script>
</html>
